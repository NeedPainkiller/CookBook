# sed

- Stream Editor

## 커맨드 {id="ubuntu_sed_1"}

| 옵션 | 설명                     |
|----|------------------------|
| -e | 	조건식 스크립트를 직접 지정       |
| -f | 	조건식 스크립트가 기재된 파일을 지정  |
| -n | 	패턴이 일치하는 라인만 출력       |
| -r | 	확장 정규표현을 사용한 스크립트를 사용 |
| -i | 	수정한 내용으로 파일 덮어쓰기      |

| subcommand | 설명                                 |
|------------|------------------------------------|
| a\         | 	현재 행에 하나 이상의 새로운 행 추가             |
| c\         | 	현재 행의 내용을 새로운 내용으로 교체             |
| d          | 	행 삭제                              |
| i\	        | 현재 행의 위에 텍스트 삽입                    |
| h          | 패턴 스페이스의 내용을 홀드 스페이스에 복사           |
| H          | 패턴 스페이스의 내용을 홀드 스페이스에 추가           |
| g	         | 홀드 스페이스의 내용을 패턴 스페이스에 덮어쓰기         |
| G          | 	홀드 스페이스의 내용을 패턴 스페이스에 추가          |
| l          | 	출력되지 않는 특수문자를 명확하게 출력             |
| p          | 	행 출력                              |
| n          | 	다음 입력 행을 첫 번째 명령어가 아닌 다음 명령어에서 처리 |
| q          | 	sed 종료                            |
| r          | 	파일로부터 행 읽어오기                      |
| !	         | 선택된 행을 제외한 나머지 전체 행에 명령어 적용        |
| s	         | 문자열 치환                             |

| 치환 플래그 | 설명                                  |
|--------|-------------------------------------|
| g	     | 치환이 행 전체에 대해 이뤄짐                    |
| p	     | 행 출력                                |
| w	     | 파일에 쓰기                              |
| x	     | 홀드 스페이스와 패턴 스페이스의 내용을 서로 맞바꾸기       |
| y	     | 한 문자를 다른 문자로 변환 (정규표현식 메타문자 사용 불가능) |

| 메타문자  | 설명                                      |
|-------|-----------------------------------------|
| ^     | 	맨 앞                                    |
| $	    | 맨 뒤                                     |
| .	    | 임의의 한 문자                                |
| *	    | 직전의 문자를 0회 이상 반복                        |
| +     | 	직전의 문자를 1회 이상 반복                       |
| \?	   | 직전의 문자가 0회 혹은 1회만 출현                    
| [ ]	  | 문자 클래스. [abc0-9]이면 숫자와 a,b,c 중 어떠한 한 문자 
| \|	   | OR. [ab                                 |ap]이면 ab 혹은 ap
| {3}	  | 직전의 문자가 3번만 출현                          
| {3,5} | 	직전의 문자가 3~5번 출현                        
| \b    | 	단어 구분                                  

### 파이프라인 활용

```Bash
cat [파일명] | sed '[패턴]' | sed '[패턴]' | sed '[패턴]'
```

## 예시

| 예시                      | 설명                                  |
|-------------------------|-------------------------------------|
| sed '/a/d' test.txt     | 	a가 포함된 행 삭제                        |
| sed 's/a//g' test.txt   | 	a가 포함된 행에서 a만 지우고 출력               |
| sed 's/ //g' test.txt   | 	행에서 공백(space) 제거                   |
| sed '/^$/d' test.txt    | 	space 조차 없는 빈 행 삭제                 |
| sed '/^\s*$/d' test.txt | 	space만 있는 빈 행이라면 해당 행 삭제           |
| sed 'a\\' test.txt      | 	행마다 위,아래 공백인 행 추가                  |
| sed 's/a.*b//'          | 	각 행에서 a ~ b 까지 전체 내용 삭제 후 출력       |
| sed 's/\[//g'           | 	특수문자인 대괄호 '[' 삭제 (역슬러시 or 달러표시 사용) |

### 개행처리

- 이슈
```Bash
error syntax error near unexpected token `$'{\r''
```

- 해결
```Bash
sed -i 's/\r//' <file_name.sh>
```

<seealso>
    <category ref="reference">
        <a href="https://velog.io/@inhwa1025/Linux-SED-명령어-사용법">[Linux] SED 명령어 사용법</a>
        <a href="https://main.tistory.com/38">[Linux] 에러: syntax error near unexpected token `$'{\r''</a>
    </category>
</seealso>

